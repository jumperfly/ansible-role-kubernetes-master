# Some vars referenced in this role are inherited from kubernetes_node, eg. kube_version

# Kubernetes master configuration
kube_master_taint_node: yes

# Kubernetes master kubelet overrides
kube_master_kubelet_args: --kubeconfig=/var/lib/kubelet/kubeconfig --pod-manifest-path=/etc/kubernetes/manifests --cluster-dns={{ kube_cluster_dns }} --cluster-domain={{ kube_cluster_domain }} --node-labels kubernetes.io/role=master {{ '--register-with-taints dedicated=master:NoSchedule' if kube_master_taint_node else '' }}

# Kubernetes apiserver configuration
kube_apiserver_listen_ip: "{{ ip }}"
kube_apiserver_etcd_group: etcd_nodes
kube_apiserver_admission_plugins: NamespaceLifecycle,LimitRanger,ServiceAccount,DefaultStorageClass,DefaultTolerationSeconds,MutatingAdmissionWebhook,ValidatingAdmissionWebhook,ResourceQuota

# Kubernetes apiserver certificate configuration
kube_apiserver_cert_etcd_ca_delegate_name: etcd-ca
kube_apiserver_cert_kube_ca_delegate_name: kubernetes-ca
kube_apiserver_cert_base_dir: /srv/kubernetes
kube_apiserver_cert_name: "apiserver-{{ ansible_hostname }}"
kube_apiserver_cert_common_name: kubernetes
kube_apiserver_cert_hosts:
  - kubernetes
  - kubernetes.default
  - kubernetes.default.svc
  - kubernetes.default.svc.cluster
  - kubernetes.default.svc.cluster.local
  - 10.0.0.1
  - "{{ kube_apiserver_listen_ip }}"
kube_apiserver_cert_country: GB
kube_apiserver_cert_city: London
kube_apiserver_cert_state: Greater London
kube_apiserver_cert_organization_name: Ansible Certificate
kube_apiserver_cert_organizational_unit_name: Kubernetes

# Kubernetes controller-manager configuration
kube_controller_manager_listen_ip: "{{ ip }}"
kube_pod_cidr_range: "10.201.0.0/16"
